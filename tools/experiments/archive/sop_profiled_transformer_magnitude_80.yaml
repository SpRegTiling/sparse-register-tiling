options:
  profile: True
  scalar_type: float
  n_threads: [ 1 ]
  b_cols: [ 128 ]
  output_file: sop_profiled_transformer_magnitude_results_70_80.csv
  save_tuning_results: False
  expand_config_parameters: [ m_tile, k_tile, n_tile ]

tuning:
  parameter_grids:
    - name: MKN_Grid_DCSB
      m_tile: [ 8, 16, 32, 64 ]
      k_tile: [ 32, 64, 128, 256, 1024, 2048 ]
      n_tile: [ 32, 64 ]

    - name: MKN_Grid_SOP
      m_tile: [ 8, 16, 32, 64 ]
      k_tile: [ 4096, 256, 128 ]
      n_tile: [ 64, 128 ]

    - name: MKN_Grid_SOP_2
      m_tile: [ 8, 16, 32, 64 ]
      k_tile: [ 4096, 256, 128, 64, 32 ]
      n_tile: [ 32, 64, 128 ]

methods:
  - name: MKL_Dense
    method_id: mkl_dense

  - name: MKL_Sparse
    method_id: mkl
    options:
      inspector: False

  - name: MKL_Sparse_IE
    method_id: mkl
    options:
      inspector: True

  - name: SOP_4
    method_id: sop
    options:
      vec_width: 512
      vec_height: 4
    tune:
      grid: MKN_Grid_SOP

  - name: SOP_8
    method_id: sop
    options:
      vec_width: 512
      vec_height: 8
    tune:
      grid: MKN_Grid_SOP_2

  - name: SOP_4_64x64x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 4
    config:
      m_tile: 64
      k_tile: 64
      n_tile: 64

  - name: SOP_8_64x64x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 8
    config:
      m_tile: 64
      k_tile: 64
      n_tile: 64

  - name: SOP_4_64x128x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 4
    config:
      m_tile: 64
      k_tile: 128
      n_tile: 64

  - name: SOP_8_64x128x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 8
    config:
      m_tile: 64
      k_tile: 128
      n_tile: 64


  - name: SOP_4_32x256x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 4
    config:
      m_tile: 32
      k_tile: 256
      n_tile: 64

  - name: SOP_8_32x256x64
    method_id: sop
    options:
      vec_width: 512
      vec_height: 8
    config:
      m_tile: 32
      k_tile: 256
      n_tile: 64

  - name: DCSB_CSR_8BIT_TUNED
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    tune:
      grid: MKN_Grid_DCSB

  - name: DCSB_CSR_64x64x64
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    config:
      m_tile: 64
      k_tile: 64
      n_tile: 64


matrices:
  filelist: ../../tools/filelists/transformer_magnitude_80.txt
