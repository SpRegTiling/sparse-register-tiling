options:
  profile: False
  scalar_type: float
  n_threads: [ 1, 8, 16, 20 ]
  b_cols: [ 128, 256 ]
  output_file: mt_hybrid_profiled_ie_transformer_magnitude_results_80.csv
  save_tuning_results: False
  expand_config_parameters: [ m_tile, k_tile, n_tile, density_threshold, agg, pct_nnz ]

tuning:
  parameter_grids:
    - name: MKN_Grid_DCSB
      m_tile: [ 8, 16, 32, 64 ]
      k_tile: [ 64 ]
      n_tile: [ 64 ]

    - name: MKN_Grid_SOP
      m_tile: [ 16, 32, 64 ]
      k_tile: [ 4096, 256, 128, 64 ]
      n_tile: [ 64, 128 ]

    - name: MKN_Grid_SOP_2
      m_tile: [ 16, 32, 64 ]
      k_tile: [ 4096, 256, 128, 64 ]
      n_tile: [ 32, 64, 128 ]

    - name: MKN_Grid_Hybrid
      m_tile: [ 32, 64 ]
      k_tile: [ 64, 128 ]
      n_tile: [ 64 ]
      density_threshold: [ 0, 20, 25, 30, 33, 35, 40 ]

    - name: MKN_Grid_Hybrid_Agg
      m_tile: [ 32, 64 ]
      k_tile: [ 64, 128 ]
      n_tile: [ 64 ]
      agg: [ 2, 4, 8, 16 ]
      density_threshold: [ 0, 25, 30, 33, 35, 40 ]

    - name: MKN_Grid_Hybrid_Pct
      m_tile: [ 32, 64 ]
      k_tile: [ 64, 128 ]
      n_tile: [ 64 ]
      pct_nnz: [ 20, 25, 30, 35, 40, 50, 100 ]

methods:
  - name: MKL_Dense
    method_id: mkl_dense

  - name: MKL_Sparse
    method_id: mkl
    options:
      inspector: False

  - name: MKL_Sparse_IE
    method_id: mkl
    options:
      inspector: True

  - name: DCSB_CSR_8BIT
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: False
      storage: CSR
    tune:
      grid: MKN_Grid_DCSB

  - name: SOP_4
    method_id: sop
    options:
      vec_width: 512
      vec_height: 4
    tune:
      grid: MKN_Grid_SOP

  - name: SOP_8
    method_id: sop
    options:
      vec_width: 512
      vec_height: 8
    tune:
      grid: MKN_Grid_SOP_2

  - name: HYBRID_ROW_BASED_TILED_SPARSE
    method_id: hyb_ie
    options:
      vec_width: 512
      8bit_row_ptrs: False
      merging_strategy: ROW_BASED
      execution_strategy: TILED_SPARSE
    tune:
      grid: MKN_Grid_Hybrid

#  - name: HYBRID_AGG_ROW_BASED_TILED_SPARSE
#    method_id: hyb_ie
#    options:
#      vec_width: 512
#      8bit_row_ptrs: False
#      merging_strategy: AGG_ROW_BASED
#      execution_strategy: TILED_SPARSE
#    tune:
#      grid: MKN_Grid_Hybrid_Agg
#
#  - name: HYBRID_PCT_BASED_TILED_SPARSE
#    method_id: hyb_ie
#    options:
#      vec_width: 512
#      8bit_row_ptrs: False
#      merging_strategy: PCT_BASED
#      execution_strategy: TILED_SPARSE
#    tune:
#      grid: MKN_Grid_Hybrid_Pct

  - name: HYBRID_ROW_BASED_MKL_SPARSE
    method_id: hyb_ie
    options:
      vec_width: 512
      8bit_row_ptrs: False
      merging_strategy: ROW_BASED
      execution_strategy: UNTILED_MKL
    tune:
      grid: MKN_Grid_Hybrid

#  - name: HYBRID_AGG_ROW_BASED_MKL_SPARSE
#    method_id: hyb_ie
#    options:
#      vec_width: 512
#      8bit_row_ptrs: False
#      merging_strategy: AGG_ROW_BASED
#      execution_strategy: UNTILED_MKL
#    tune:
#      grid: MKN_Grid_Hybrid_Agg
#
#  - name: HYBRID_PCT_BASED_MKL_SPARSE
#    method_id: hyb_ie
#    options:
#      vec_width: 512
#      8bit_row_ptrs: False
#      merging_strategy: PCT_BASED
#      execution_strategy: UNTILED_MKL
#    tune:
#      grid: MKN_Grid_Hybrid_Pct

matrices:
  filelist: ../../tools/filelists/hybrid_file_list_80.txt
