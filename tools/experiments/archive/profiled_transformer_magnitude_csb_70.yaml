options:
  profile: True
  scalar_type: float
  n_threads: 1
  b_cols: 128
  output_file: profiled_transformer_magnitude_results_70.csv
  save_tuning_results: False
  expand_config_parameters: [ m_tile, k_tile, n_tile ]

tuning:
  parameter_grids:
#    - name: MKN_Grid
#      m_tile: [ 16, 32, 64 ]
#      k_tile: [ 64, 128, 256 ]
#      n_tile: [ 64, 128 ]
#
#    - name: MN_Grid
#      m_tile: [ 16, 32, 64 ]
#      n_tile: [ 64, 128 ]
#
    - name: MKN_Grid_DCSB
      m_tile: [ 32, 40, 48, 56, 64 ]
      k_tile: [ 32, 40, 48, 56, 64 ]
      n_tile: [ 128 ]
#
#    - name: MKN_Grid_DCSB_CSC
#      m_tile: [ 16, 32, 64 ]
#      k_tile: [ 64, 128 ]
#      n_tile: [ 64, 128 ]

methods:
  - name: MKL_Dense
    method_id: mkl_dense

  - name: MKL_Executor_Only
    method_id: mkl
    options:
      inspector: False

  - name: DCSB_CSR_8BIT_64x64x128
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    config:
      m_tile: 64
      k_tile: 64
      n_tile: 128

  - name: DCSB_CSR_8BIT_56x56x128
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    config:
      m_tile: 56
      k_tile: 56
      n_tile: 128

  - name: DCSB_CSR_8BIT_64x32x128
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    config:
      m_tile: 64
      k_tile: 32
      n_tile: 128

  - name: DCSB_CSR_8BIT_32x32x128
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    config:
      m_tile: 32
      k_tile: 32
      n_tile: 128

  - name: DCSB_CSR_8BIT_TUNED
    method_id: dcsb
    options:
      vec_width: 512
      8bit_row_ptrs: True
      storage: CSR
    tune:
      grid: MKN_Grid_DCSB


matrices:
  filelist: ../../tools/filelists/transformer_magnitude_70.txt
